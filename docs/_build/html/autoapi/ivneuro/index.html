<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ivneuro &mdash; ivneuro  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=bbec6902"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ivneuro.nex" href="nex/index.html" />
    <link rel="prev" title="API Reference" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ivneuro
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nex/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.nex</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="continuous/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.continuous</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="delta_coherence/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_coherence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="delta_coherence_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_coherence_core</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="delta_power_spectral/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_power_spectral</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="delta_power_spectral_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_power_spectral_core</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="events/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.events</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="generate_signal/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.generate_signal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spectograms/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.spectograms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spectograms_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.spectograms_core</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="tracking/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.tracking</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attributes">Attributes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to ivneuro</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ivneuro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API Reference</a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/autoapi/ivneuro/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ivneuro">
<span id="ivneuro"></span><h1><a class="reference internal" href="#module-ivneuro" title="ivneuro"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro</span></code></a><a class="headerlink" href="#module-ivneuro" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="nex/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.nex</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="nex/NexData/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.nex.NexData</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="nex/nexfile/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.nex.nexfile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="nex/pull_nex_data/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.nex.pull_nex_data</span></code></a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="continuous/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.continuous</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="delta_coherence/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_coherence</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="delta_coherence_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_coherence_core</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="delta_power_spectral/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_power_spectral</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="delta_power_spectral_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.delta_power_spectral_core</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="events/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.events</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="generate_signal/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.generate_signal</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="spectograms/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.spectograms</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="spectograms_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.spectograms_core</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="tracking/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.tracking</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ivneuro.utils</span></code></a></li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Permalink to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.EventPosition" title="ivneuro.EventPosition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventPosition</span></code></a></p></td>
<td><p>Obtain the position of an event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.PeriEventHistogram" title="ivneuro.PeriEventHistogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PeriEventHistogram</span></code></a></p></td>
<td><p>Create a PeriEventHistogram object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.PeriEventSpectogram" title="ivneuro.PeriEventSpectogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PeriEventSpectogram</span></code></a></p></td>
<td><p>Create a PeriEventHistogram object.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.make_intervals" title="ivneuro.make_intervals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_intervals</span></code></a>(timestamps, start, end)</p></td>
<td><p>Make intervals based on timestamps.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.classify_events_base_on_time" title="ivneuro.classify_events_base_on_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">classify_events_base_on_time</span></code></a>(event1, event2, treshold)</p></td>
<td><p>Classify an event in two categories based on how close in time it occurs from an event of reference.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.scale_centroids" title="ivneuro.scale_centroids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale_centroids</span></code></a>(centroids, x_dim, y_dim)</p></td>
<td><p>Scale centroids to match the real values in appropiate scale.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.calculate_speed" title="ivneuro.calculate_speed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_speed</span></code></a>(X_values, Y_values, timestamps[, smooth])</p></td>
<td><p>Calculate scalar speed.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.position_of_event" title="ivneuro.position_of_event"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_of_event</span></code></a>(x_values, y_values, timestamps, events)</p></td>
<td><p>Estimate the most likely position at with an event occurs, or get all the positions where that event occurs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.distances_to_position" title="ivneuro.distances_to_position"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distances_to_position</span></code></a>(x_values, y_values, position)</p></td>
<td><p>Given a set of x and y positions, calculate the distance to a specific position at each row.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.calculate_sampling_period" title="ivneuro.calculate_sampling_period"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_sampling_period</span></code></a>(timestamps)</p></td>
<td><p>Calculate the sampling period from an array of timestamps</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.calculate_sampling_rate" title="ivneuro.calculate_sampling_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_sampling_rate</span></code></a>(timestamps)</p></td>
<td><p>Calculate sampling rate from an array of timestamps</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.peh" title="ivneuro.peh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">peh</span></code></a>(contvar, evt, lower_lim, higher_lim[, ...])</p></td>
<td><p>Make peri-event histograms</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.peri_event_spectogram" title="ivneuro.peri_event_spectogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">peri_event_spectogram</span></code></a>(contvar, evt, lower_lim, higher_lim)</p></td>
<td><p>Calculate peri-event spectograms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.normalize_pes" title="ivneuro.normalize_pes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize_pes</span></code></a>(pes[, baseline, method])</p></td>
<td><p>Normalize peri-event-histogram using the formula (X - Mean(baseline)) / Mean(baseline) for each frequency, where X is every value and Mean(baseline) is the mean value of a baseline.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.plot_pes" title="ivneuro.plot_pes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_pes</span></code></a>(pes[, zero_centered, aspect])</p></td>
<td><p>Plot peri-event spectograms, with each variable in a column and each event name in a row.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.delta_power_spectral" title="ivneuro.delta_power_spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delta_power_spectral</span></code></a>(contvar, exp_interval, baseline)</p></td>
<td><p>Calculate the power spectral at a experimental time of interest (exp_interval), at a baseline interval (baseline), and the frequency-basis normalized difference betrween the experimental interval and the baseline.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.delta_coherence" title="ivneuro.delta_coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delta_coherence</span></code></a>(contvar, exp_interval, baseline[, ...])</p></td>
<td><p>Calculate the coherence between 2 signals at a experimental interval of time of interest (exp_interval), at a baseline interval of time (baseline), and the difference betrween the spectral at the experimental interval and the baseline.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.generate_signal" title="ivneuro.generate_signal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_signal</span></code></a>(duration, burst_timestamps, ...[, ...])</p></td>
<td><p>Generate a signal with pink noise and increases in power (bursts) at a specified frequency.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.__doc__" title="ivneuro.__doc__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__doc__</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ivneuro.__author__" title="ivneuro.__author__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__author__</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ivneuro.__version__" title="ivneuro.__version__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__version__</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py data">
<dt class="sig sig-object py" id="ivneuro.__doc__">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Multiline-String</span></em><a class="headerlink" href="#ivneuro.__doc__" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><details><summary>Show Value</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">ivneuro</span>
<span class="sd">=======</span>
<span class="sd">Tools for processing and analyzing neurophysiological signals recorded in-vivo.</span>


<span class="sd">ivneuro provides tools for analyzing neural signals recorded in-vivo during behavior. It</span>
<span class="sd">focus on time series analyses of continuous variables such as Local Field Potentials and</span>
<span class="sd">is optimized to process either single signals in a single condition as well as multiple</span>
<span class="sd">signals in multiple conditions simultaneously. It also provides a subpackage for extracting</span>
<span class="sd">data from Nex files.</span>

<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</details></div></blockquote>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ivneuro.__author__">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">__author__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Eric</span> <span class="pre">Casey'</span></em><a class="headerlink" href="#ivneuro.__author__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ivneuro.__version__">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">__version__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'0.1.3'</span></em><a class="headerlink" href="#ivneuro.__version__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.make_intervals">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">make_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/events.html#make_intervals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.make_intervals" title="Permalink to this definition"></a></dt>
<dd><p>Make intervals based on timestamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestamps</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – Timestamps to use as reference to make intervals.</p></li>
<li><p><strong>start</strong> (<em>int</em><em> or </em><em>float</em>) – Start of interval, relative to timestamps.</p></li>
<li><p><strong>end</strong> (<em>int</em><em> or </em><em>float</em>) – End of interval, relative to timestamps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Slices with the start time and end time of each interval.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create intervals using make_intervals function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span> <span class="c1"># Timestamps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make intervals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intervals</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">make_intervals</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
<span class="go">[slice(10, 13, None), slice(20, 23, None), slice(30, 33, None)]</span>
</pre></div>
</div>
<p>Use intervals to slice a pandas.DataFrame</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create dataframe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Slice datafrane</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">]</span>
<span class="go">[      values</span>
<span class="go"> 10  0.320519</span>
<span class="go"> 11  0.366415</span>
<span class="go"> 12  0.709652</span>
<span class="go"> 13  0.900142,</span>
<span class="go">       values</span>
<span class="go"> 20  0.842780</span>
<span class="go"> 21  0.306013</span>
<span class="go"> 22  0.631170</span>
<span class="go"> 23  0.680239,</span>
<span class="go">       values</span>
<span class="go"> 30  0.486032</span>
<span class="go"> 31  0.807219</span>
<span class="go"> 32  0.844220</span>
<span class="go"> 33  0.534681]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.classify_events_base_on_time">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">classify_events_base_on_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/events.html#classify_events_base_on_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.classify_events_base_on_time" title="Permalink to this definition"></a></dt>
<dd><p>Classify an event in two categories based on how close in time it occurs from an event of reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event1</strong> (<em>numpy.array</em><em> of </em><em>shape</em><em> (</em><em>1 x n</em><em>)</em>) – Event to classify.</p></li>
<li><p><strong>event2</strong> (<em>numpy.array</em><em> of </em><em>shape</em><em> (</em><em>1 x m</em><em>)</em>) – Event of reference.</p></li>
<li><p><strong>treshold</strong> (<em>TYPE</em>) – Threshold amount of time used to classify events.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Define the mode of evaluation of proximity. “left”, only looks event1 that occur before event2; “right”,
only looks event1 that ocurr after event2; “two-sides”, look temporal proximity before and after. The default is ‘left’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>near</strong> (<em>np.array of shape (1 x o)</em>) – Subset of event1 classified as temporally close to event2.</p></li>
<li><p><strong>far</strong> (<em>np.array of shape (1 x p).</em>) – Subset of event1 classified as temporally far from event2.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Classify events with classify_events_base_on_time function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Import packages and create events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">,</span> <span class="mf">15.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Classify events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">near</span><span class="p">,</span> <span class="n">far</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">classify_events_base_on_time</span><span class="p">(</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">,</span> <span class="n">treshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">near</span><span class="p">)</span>
<span class="go">[7.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">far</span><span class="p">)</span>
<span class="go">[ 3.  10.5 15.3]</span>
</pre></div>
</div>
<p>Set mode to ‘right’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">near</span><span class="p">,</span> <span class="n">far</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">classify_events_base_on_time</span><span class="p">(</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">,</span> <span class="n">treshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">near</span><span class="p">)</span>
<span class="go">[15.3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">far</span><span class="p">)</span>
<span class="go">[ 3.   7.  10.5]</span>
</pre></div>
</div>
<p>Set mode to ‘both’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">near</span><span class="p">,</span> <span class="n">far</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">classify_events_base_on_time</span><span class="p">(</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">,</span> <span class="n">treshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;two-sides&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">near</span><span class="p">)</span>
<span class="go">[ 7.  15.3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">far</span><span class="p">)</span>
<span class="go">[ 3.  10.5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.scale_centroids">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">scale_centroids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#scale_centroids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.scale_centroids" title="Permalink to this definition"></a></dt>
<dd><p>Scale centroids to match the real values in appropiate scale.</p>
<p>This function assumes that positions at lower and higher limits of each dimension have been recorded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centroids</strong> (<em>numpy.ndarray</em><em> of </em><em>shape</em><em> (</em><em>2 x n_timestamps</em><em>)</em>) – Values of X_centroid and Y_centroid to be scaled.</p></li>
<li><p><strong>x_dim</strong> (<em>float</em>) – Value from end to end of X coordinate.</p></li>
<li><p><strong>y_dim</strong> (<em>float</em>) – Value from end to end of Y coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray with scaled values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Use scale_centroids function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create and array with x and y coordinates: centroids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="c1"># Coordinates for an oval trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale using scale_centroids function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_centroids</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">scale_centroids</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="go">Difference between observed and provided x/y ratios: -0.012587232612482069 %</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaled_centroids</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">])</span> <span class="c1"># Print first 5 values of x and y</span>
<span class="go">array([[15.        , 14.98489627, 14.9396459 , 14.8644311 , 14.75955473],</span>
<span class="go">       [15.        , 15.95147856, 16.89912585, 17.83912603, 18.76769406]])</span>
</pre></div>
</div>
<p>If ratios between observed and provided x and y values are too different, scale_centroids will through a warning message.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale with inverted x and y measures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_centroids</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">scale_centroids</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="go">Warning: the observed and provided x/y ratios have a difference of above 10%, consider switching the order of X and Y dimensions or cleaning centroids data and scale again</span>
<span class="go">Difference between observed and provided x/y ratios: -75.00314680815312 %</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.calculate_speed">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">calculate_speed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#calculate_speed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.calculate_speed" title="Permalink to this definition"></a></dt>
<dd><p>Calculate scalar speed.</p>
<p>Speed is calculated through the following steps:
1. Calculate dtime, dX=PosX[T-deltaT]-posX[T] and dY=PosY[T-deltaT]-posY[T].
2. Smooth dX and dY using a Gaussian filter. Note: by applying the Gaussian filter to dX and dY instead of the speed
avoids short movements or random noie of the camera  to propagate to the speed calculus, leaving only changes in position caused
by displacement.
3. Calculate scalar speed: sqrt(dX**2+dY**2) / dT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_values</strong> (<em>NUMPY ARRAY</em>) – Positions in X coordinate. Must have the same lenght than Y_values and timestamps</p></li>
<li><p><strong>Y_values</strong> (<em>NUMPY ARRAY</em>) – Positions in Y coordinate. Must have the same lenght than X_values and timestamps</p></li>
<li><p><strong>timestamps</strong> (<em>NUMPY ARRAY</em>) – Timestamps for every position. Must have the same lenght than X_values and Y_values</p></li>
<li><p><strong>smooth</strong> (<em>Float</em><em>, </em><em>optional</em>) – Defines the window of time a 2 x smooth and the width of the  Gaussian kernel as 1 x smooth,
for the Gaussian filter. The default is 0, in which case the Gaussian filter is not appplied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>speed</strong> – Values of scalar speed</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create x coordinates, y coordinates and  timestamps. Calculate speed and print it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go"># Calculate speed with calculate_speed function and print the first 5 values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">speed</span><span class="o">=</span><span class="n">ivn</span><span class="o">.</span><span class="n">calculate_speed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">speed</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[6.3431908  6.32404896 6.28590074 6.22901826 6.15381269]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.position_of_event">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">position_of_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.median</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#position_of_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.position_of_event" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the most likely position at with an event occurs, or get all the positions where that event occurs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_values</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – All positions in x axis. Must be of the same lenght than y_values and timestamps</p></li>
<li><p><strong>y_values</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – All positions in y axis. Must be of the same lenght than x_values and timestamps</p></li>
<li><p><strong>timestamps</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – All timestamps. Must be of the same lenght than x_values and y_values.</p></li>
<li><p><strong>events</strong> (<em>one dimensional numpy.array</em><em> or </em><em>list</em><em> of </em><em>floats</em>) – Timestamps of the event.</p></li>
<li><p><strong>estimator</strong> (<em>function</em><em>, </em><em>optional</em>) – Function to be used to estimate the most likely position of the event. The default is np.median.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If x_values, y_values or timestamps is not np.ndarray.</p></li>
<li><p><strong>ValueError</strong> – If x_values lenght, y_values lenght and timestamps lenght are not the same.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Most likely position (x, y) if estimator is not None, or all the positions of the event (np.array([x])), np.array([y]) if estimator is None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Estimate the position of an event with the median.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create x coordinates, y coordinates, centroids timestamps and event.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">ts</span><span class="p">[(</span><span class="n">ts</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ts</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">)],</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># Create an event by making a random choice from timestamps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Estimate the position with position_of_event, return the median</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">position_of_event</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
<span class="go">(1.7632341857016716, 8.658802722744587)</span>
</pre></div>
</div>
<p>Return the mean of the positions</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">position_of_event</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">estimator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<span class="go">(3.356415004157808, 7.336570446958302)</span>
</pre></div>
</div>
<p>Return all the positions for x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">position_of_event</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">estimator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">(array([5.        , 0.83891543, 8.57685162, 0.60307379, 1.76323419]),</span>
<span class="go"> array([ 2.67949192, 11.98138929,  0.20357116, 13.15959713,  8.65880272]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.distances_to_position">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">distances_to_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#distances_to_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.distances_to_position" title="Permalink to this definition"></a></dt>
<dd><p>Given a set of x and y positions, calculate the distance to a specific position at each row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_values</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – X_centroid positions at each timestamp. Must be of the same lenght than y_values and timestamps</p></li>
<li><p><strong>y_values</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – </p></li>
<li><p><strong>position</strong> (<em>tuple</em>) – Position (x, y) to calculate distance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One dimensional array with distances to position at every point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Calculate distances to a position.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create x coordinates and y coordinates, create position of interest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="c1"># Position of interest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate distances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distances</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">distances_to_position</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">distances</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[10.         10.06015795 10.23756293 10.523536   10.90516361]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ivneuro.EventPosition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">EventPosition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.median</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the position of an event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_values</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – All positions in x axis. Must be of the same lenght than y_values and timestamps</p></li>
<li><p><strong>y_values</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – All positions in y axis. Must be of the same lenght than x_values and timestamps</p></li>
<li><p><strong>timestamps</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>1 X n_timestamps</em><em>)</em>) – All timestamps. Must be of the same lenght than x_values and y_values.</p></li>
<li><p><strong>events</strong> (<em>one dimensional numpy.array</em><em> or </em><em>list</em><em> of </em><em>floats</em>) – Timestamps of the event.</p></li>
<li><p><strong>estimator</strong> (<em>function</em><em>, </em><em>optional</em>) – Function to be used to estimate the most likely position of the event. The default is np.median.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If x_values, y_values or timestamps is not np.ndarray.</p></li>
<li><p><strong>ValueError</strong> – If x_values lenght, y_values lenght and timestamps lenght are not the same.</p></li>
<li><p><strong>ValueError</strong> – If estimator == None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.EventPosition.x_values">
<span class="sig-name descname"><span class="pre">x_values</span></span><a class="headerlink" href="#ivneuro.EventPosition.x_values" title="Permalink to this definition"></a></dt>
<dd><p>All positions in x axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.EventPosition.y_values">
<span class="sig-name descname"><span class="pre">y_values</span></span><a class="headerlink" href="#ivneuro.EventPosition.y_values" title="Permalink to this definition"></a></dt>
<dd><p>All positions in y axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.EventPosition.timestamps">
<span class="sig-name descname"><span class="pre">timestamps</span></span><a class="headerlink" href="#ivneuro.EventPosition.timestamps" title="Permalink to this definition"></a></dt>
<dd><p>All timestamps</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.EventPosition.events">
<span class="sig-name descname"><span class="pre">events</span></span><a class="headerlink" href="#ivneuro.EventPosition.events" title="Permalink to this definition"></a></dt>
<dd><p>Timestamps of the event.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.EventPosition.estimator">
<span class="sig-name descname"><span class="pre">estimator</span></span><a class="headerlink" href="#ivneuro.EventPosition.estimator" title="Permalink to this definition"></a></dt>
<dd><p>The function used to estimate the most likelly position.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.EventPosition.estimated_position">
<span class="sig-name descname"><span class="pre">estimated_position</span></span><a class="headerlink" href="#ivneuro.EventPosition.estimated_position" title="Permalink to this definition"></a></dt>
<dd><p>Most likely position (x, y).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.EventPosition.position_std">
<span class="sig-name descname"><span class="pre">position_std</span></span><a class="headerlink" href="#ivneuro.EventPosition.position_std" title="Permalink to this definition"></a></dt>
<dd><p>Standar deviation for the positions of th event (std(x), std(y))</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition.distances_to_event">
<span class="sig-name descname"><span class="pre">distances_to_event</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.distances_to_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition.distances_to_event" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the distance to the event estimated position at each timestamp</p>
<dl class="simple">
<dt>Returns: np.ndarray</dt><dd><p>One dimensional array with distances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition.set_distances_to_event">
<span class="sig-name descname"><span class="pre">set_distances_to_event</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.set_distances_to_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition.set_distances_to_event" title="Permalink to this definition"></a></dt>
<dd><p>Set distances_to_event attribute using distances_to_event function</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">all_event_positions():</span></span></dt>
<dd><p>Get all the positions at wich the event occurrs.</p>
<dl class="simple">
<dt>Returns: tuple</dt><dd><p>All the positions of the event (np.array([x])), np.array([y]).</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt>get_event_position_std():</dt><dd><p>Calculate the standar deviation for the event position at x and y axis.</p>
<dl class="simple">
<dt>Returns: tuple</dt><dd><p>Standar deviation in x and y (std(x), std(y))</p>
</dd>
</dl>
</dd>
<dt>plot():</dt><dd><p>plot the all the trajectory, positions where the event occurred and the event estimated position</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition.__str__" title="Permalink to this definition"></a></dt>
<dd><p>Return str(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition.__repr__" title="Permalink to this definition"></a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition._position_of_event">
<span class="sig-name descname"><span class="pre">_position_of_event</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition._position_of_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition._position_of_event" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">distances_to_event</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.distances_to_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">set_distances_to_event</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.set_distances_to_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition.all_event_positions">
<span class="sig-name descname"><span class="pre">all_event_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.all_event_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition.all_event_positions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition.get_event_position_std">
<span class="sig-name descname"><span class="pre">get_event_position_std</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.get_event_position_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition.get_event_position_std" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.EventPosition.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/tracking.html#EventPosition.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.EventPosition.plot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.calculate_sampling_period">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">calculate_sampling_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#calculate_sampling_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.calculate_sampling_period" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the sampling period from an array of timestamps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timestamps</strong> (<em>numpy.ndarray</em>) – One dimensional array with timestamps.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampling period.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Calculate sample period of a timeserie.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create timeserie</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span> <span class="c1"># Timeserie of period 0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use the function to calculate sample period.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">calculate_sampling_period</span><span class="p">(</span><span class="n">timestamps</span><span class="p">)</span>
<span class="go">0.001000000000000334</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.calculate_sampling_rate">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">calculate_sampling_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#calculate_sampling_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.calculate_sampling_rate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate sampling rate from an array of timestamps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timestamps</strong> (<em>numpy.ndarray</em>) – One dimensional array with timestamps.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sampling_rate</strong> – Sampling rate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Calculate sample rate of a timeserie.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create timeserie</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span> <span class="c1"># Timeserie of period 0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use the function to calculate sample rate.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">calculate_sampling_rate</span><span class="p">(</span><span class="n">timestamps</span><span class="p">)</span>
<span class="go">1000.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.peh">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">peh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">higher_lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_DataFrame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#peh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.peh" title="Permalink to this definition"></a></dt>
<dd><p>Make peri-event histograms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contvar</strong> (<em>pandas.DataFrame</em>) – Dataframe with continuous variables in each column, and timestamps as index.</p></li>
<li><p><strong>evt</strong> (<em>one-dimensional numpy.ndarray</em><em>, </em><em>list</em><em> or </em><em>dict</em>) – Timestamps of a single reference event if evt is a one-dimesional np.ndarray or a list. If multiple events are analized, evt must be a dict with event names as keys and timestamps as values, for every reference event.
Dict values can be either one dimensional numpy arrays or lists of floats.</p></li>
<li><p><strong>lower_lim</strong> (<em>int</em><em> or </em><em>float</em>) – Lower time limit of the peri-event histogram.</p></li>
<li><p><strong>higher_lim</strong> (<em>int</em><em> or </em><em>float</em>) – Higher time limit of the peri-event histogram.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>peh</strong> – Dataframe of peri-event histograms with original continuous variables as columns, and multi-index with event names, trial number and peri-event time.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create event and signals.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create events: burst and control</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">burst</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;burst&#39;</span><span class="p">:</span><span class="n">burst</span><span class="p">,</span><span class="s1">&#39;control&#39;</span><span class="p">:</span><span class="n">control</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">burst_duration</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">burst_duration</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">21</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal3</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">burst_duration</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">signal3</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Peri-event histograms for a single variable and a single event (with multiple trials).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peh</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="n">lower_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">higher_lim</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># histograms from 5 seconds before to 5 seconds after each trial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="go">ivneuro.continuous.PeriEventHistogram</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span>
<span class="go">                                Signal 2Hz</span>
<span class="go">Event_name Event_number Time</span>
<span class="go">Event      1            -5.000    0.308629</span>
<span class="go">                        -4.999    0.383986</span>
<span class="go">                        -4.998    0.337540</span>
<span class="go">                        -4.997    0.301379</span>
<span class="go">                        -4.996    0.396404</span>
<span class="go">                                   ...</span>
<span class="go">           9             4.996    1.773434</span>
<span class="go">                         4.997    1.768014</span>
<span class="go">                         4.998    1.742938</span>
<span class="go">                         4.999    1.684667</span>
<span class="go">                         5.000    1.573737</span>
<span class="go">[90009 rows x 1 columns]</span>
</pre></div>
</div>
<p>Return a pandas.DataFrame instead of a ivneuro.continuous.PeriEventHistogram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peh</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="n">lower_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">higher_lim</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">return_DataFrame</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># histograms from 5 seconds before to 5 seconds after each trial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="go">pandas.core.frame.DataFrame</span>
</pre></div>
</div>
<p>Peri-event histogram for multiple variables and multiple events (with multiple trials each).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peh</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">lower_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">higher_lim</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># histograms from 3 seconds before to 3 seconds after each trial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="o">.</span><span class="n">variable_names</span>
<span class="go">[&#39;Signal 2Hz&#39;, &#39;Signal 0.5Hz&#39;, &#39;Signal 0.2Hz&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="o">.</span><span class="n">event_names</span>
<span class="go">[&#39;control&#39;, &#39;burst&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="o">.</span><span class="n">calculate_means</span><span class="p">()</span>
<span class="go">                   Signal 2Hz  Signal 0.5Hz  Signal 0.2Hz</span>
<span class="go">Event_name Time</span>
<span class="go">burst      -3.000   -0.323144      0.421450      0.436888</span>
<span class="go">           -2.999   -0.234888      0.370375      0.440265</span>
<span class="go">           -2.998   -0.232368      0.398991      0.406327</span>
<span class="go">           -2.997   -0.233245      0.368178      0.381116</span>
<span class="go">           -2.996   -0.223524      0.319660      0.367928</span>
<span class="go">                      ...           ...           ...</span>
<span class="go">control     2.996    0.245362      0.387958      0.362177</span>
<span class="go">            2.997    0.270217      0.431107      0.326198</span>
<span class="go">            2.998    0.263590      0.420351      0.303861</span>
<span class="go">            2.999    0.335115      0.444825      0.323329</span>
<span class="go">            3.000    0.361686      0.388019      0.330680</span>
<span class="go">[12002 rows x 3 columns]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">PeriEventHistogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
<p>Create a PeriEventHistogram object.</p>
<p>PeriEventHistogram class inherits from pandas.DataFrame and adds functionalities for easily extract information from the data and plot it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pandas.DataFrame</em>) – Multi-index pandas.DataFrame as returned by peh() function, with event names, event trial number and peri-event time as index, continuous variables as columns and values as data.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><a class="headerlink" href="#ivneuro.PeriEventHistogram.variable_names" title="Permalink to this definition"></a></dt>
<dd><p>Names of each continuous variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram.event_names">
<span class="sig-name descname"><span class="pre">event_names</span></span><a class="headerlink" href="#ivneuro.PeriEventHistogram.event_names" title="Permalink to this definition"></a></dt>
<dd><p>Names of each reference event.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram.timestamps">
<span class="sig-name descname"><span class="pre">timestamps</span></span><a class="headerlink" href="#ivneuro.PeriEventHistogram.timestamps" title="Permalink to this definition"></a></dt>
<dd><p>Timestamps of the peri-event histogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">slice_time(new_limits):</span></span></dt>
<dd><p>Slice timestamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_limits</strong> (<em>tuple</em>) – New lowest and highest limits of time.</p></li>
<li><p><strong>Returns</strong> (<a class="reference internal" href="#ivneuro.PeriEventHistogram" title="ivneuro.PeriEventHistogram"><em>PeriEventHistogram</em></a>) – New object with sliced timestamps</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>slice_events(event_list):</p>
<blockquote>
<div><p>Slice events.</p>
<dl class="simple">
<dt>event_list: list</dt><dd><p>Event names to slice from the data.</p>
</dd>
<dt>Returns: PeriEventHistogram</dt><dd><p>New object with sliced events.</p>
</dd>
</dl>
</div></blockquote>
<p>calculate_means():</p>
<blockquote>
<div><p>Calculate means across trials of the same event for each variable, event name and timestamp.</p>
</div></blockquote>
<dl class="simple">
<dt>Returns: pandas.DataFrame</dt><dd><p>Mean across trials of the same event of the peri-event histograms. Multi-index pandas.DataFrame with event names and peri-event time as index,
continuous variable names as columns and mean variable values as data.</p>
</dd>
</dl>
<p>plot(aspect=1, cont_names = None, evt_names = None, sharey=’all’):</p>
<blockquote>
<div><p>Plot peri-event histograms, with each variable in a column and each event name in a row.</p>
<dl class="simple">
<dt>aspect<span class="classifier">float, optional</span></dt><dd><p>The y/x ratio of the axes aspect. The default is 1.</p>
</dd>
<dt>cont_names: list or None, optional</dt><dd><p>Subset of continuous variables names to plot. If None, all variables are ploted. Default is None.</p>
</dd>
<dt>evt_names: list or None, optional</dt><dd><p>Subset of events to plot. If None, all events are ploted. Default is None.</p>
</dd>
<dt>sharey: bool or {‘none’, ‘all’, ‘row’, ‘col’}, optional</dt><dd><p>Parameter of matplotlib.pyplot.subplots() to control sharing of properties among y axis. Refer to matplotlib.pyplot.subplots in matplotlib manual for more information.
True or ‘all’: x- or y-axis will be shared among all subplots.
False or ‘none’: each subplot x- or y-axis will be independent.
‘row’: each subplot row will share an x- or y-axis.
‘col’: each subplot column will share an x- or y-axis.
The default is ‘all’.</p>
</dd>
</dl>
<p>None.</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram._set_variable_names">
<span class="sig-name descname"><span class="pre">_set_variable_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram._set_variable_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram._set_variable_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram._set_event_names">
<span class="sig-name descname"><span class="pre">_set_event_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram._set_event_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram._set_event_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram._set_timestamps">
<span class="sig-name descname"><span class="pre">_set_timestamps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram._set_timestamps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram._set_timestamps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram.slice_time">
<span class="sig-name descname"><span class="pre">slice_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_limits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram.slice_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram.slice_time" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram.slice_events">
<span class="sig-name descname"><span class="pre">slice_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram.slice_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram.slice_events" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram.calculate_means">
<span class="sig-name descname"><span class="pre">calculate_means</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram.calculate_means"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram.calculate_means" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventHistogram.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evt_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/continuous.html#PeriEventHistogram.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventHistogram.plot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.peri_event_spectogram">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">peri_event_spectogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">higher_lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">higher_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_subsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_DataFrame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spectrum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noverlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#peri_event_spectogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.peri_event_spectogram" title="Permalink to this definition"></a></dt>
<dd><p>Calculate peri-event spectograms.</p>
<p>The algorithm is based on the spectogram() function of the signal processing module of the scipyi package (scipy.signal.spectogram()), and is optimized to calculate peri-event spectograms from multiple continuous variables and/or multiple events,
with multiple trials of each event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contvar</strong> (<em>pandas.DataFrame</em>) – Dataframe with continuous variables in each column, and timestamps as index.</p></li>
<li><p><strong>evt</strong> (<em>one-dimensional numpy.ndarray</em><em>, </em><em>list</em><em> or </em><em>dict</em>) – Timestamps of a single reference event if evt is a one-dimesional np.ndarray or a list. If multiple events are analized, evt must be a dict with event names as keys and timestamps as values, for every reference event.
Dict values can be either one dimensional numpy arrays or lists of floats.</p></li>
<li><p><strong>lower_lim</strong> (<em>int</em><em> or </em><em>float</em>) – Lower time limit of the peri-event histogram.</p></li>
<li><p><strong>higher_lim</strong> (<em>int</em><em> or </em><em>float</em>) – Higher time limit of the peri-event histogram.</p></li>
<li><p><strong>lower_freq</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – The lowest frequency to include in the spectogram. The default is 0.</p></li>
<li><p><strong>higher_freq</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – The highest freq to include in the spectogram. The default is 500.</p></li>
<li><p><strong>sample_subsamples</strong> (<em>dict</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – When a dict, key must be sample names and values must be lists of subsample names, e.g.: {‘sample_A’:[‘subsample_A1’,’subsample_A2’…’subsample_An’], ‘sample_B’:[‘subsample_B1’,’subsample_B2’…’subsample_Bn’]…}.
Peri-event spectograms will be averaged across subsamples of the same sample, per each time and trial of each event, and the Variable name will be the sample name, intead of the column name of contvar.
It must only be used when contvar contains multiple replicates for each observation (e.g., local field potentials recorded with multiple wires of the same tetrode).
If None, each column of contvar is treated as an independent sample, and therefore the result contains peri-event spectograms of every contvar column. The default is None.</p></li>
<li><p><strong>return_DataFrame</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, a pandas.DataFrame is returnes. If false, a PeriEventHistogram object is returned. The default is False.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em><em>, </em><em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Sampling rate of the continuous value. If None, the sampling_rate is calculated using the inverse of the median difference between consecutive timestamps of the contvar’s index. The default is None.</p></li>
<li><p><strong>scaling</strong> (<em>str</em><em>, </em><em>optional</em>) – The scaling parameter to enter to signal.spectrogram() function of the scipy package. Refer to scipy.signal.spectogram in scipy manual for more information. The default is ‘spectrum’.</p></li>
<li><p><strong>nperseg</strong> (<em>int</em><em>, </em><em>optional</em>) – The nperseg parameter to enter to signal.spectrogram() function of the scipy package. Refer to scipy.signal.spectogram in scipy manual for more information. The default is 500.</p></li>
<li><p><strong>noverlap</strong> (<em>int</em><em>, </em><em>optional</em>) – The noverlap parameter to enter to signal.spectrogram() function of the scipy package. Refer to scipy.signal.spectogram in scipy manual for more information. The default is 400.</p></li>
<li><p><strong>nfft</strong> (<em>int</em><em>, </em><em>optional</em>) – The nfft parameter to enter to signal.spectrogram() function of the scipy package. Refer to scipy.signal.spectogram in scipy manual for more information. The default is 2000.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If evt type is neither np.ndarray, list, dict.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pes</strong> – If return_DataFrame == True, multi-index pandas.DataFrame with original continuous variable names, event names, event trial number and peri-event time as index, frequencies as columns and power values as data.
If return_DataFrame == False, PeriEventSpectogram object with the already described pandas.DataFrame as data, and normalization = ‘None’.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame or <a class="reference internal" href="#ivneuro.PeriEventSpectogram" title="ivneuro.PeriEventSpectogram">PeriEventSpectogram</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create events and signals.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create events: burst and control</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">burst</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;burst&#39;</span><span class="p">:</span><span class="n">burst</span><span class="p">,</span><span class="s1">&#39;control&#39;</span><span class="p">:</span><span class="n">control</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal3</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">signal3</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Peri-event spectograms for a single variable and a single event (with multiple trials).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate peri-event spectogram from 10 sec before to 10 seconds after each event</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peri_event_spectogram</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">pes</span><span class="p">)</span>
<span class="go">ivneuro.spectograms.PeriEventSpectogram</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span><span class="o">.</span><span class="n">data</span>
<span class="go">                                                0.0    ...         500.0</span>
<span class="go">Variable_name Event_name Event_number Time             ...</span>
<span class="go">Signal 30Hz   Event      1            -10.0  0.003922  ...  7.248012e-08</span>
<span class="go">                                      -9.9   0.000142  ...  9.831598e-08</span>
<span class="go">                                      -9.8   0.020257  ...  2.587770e-06</span>
<span class="go">                                      -9.7   0.005431  ...  5.538603e-06</span>
<span class="go">                                      -9.6   0.002156  ...  5.956565e-06</span>
<span class="go">                                                  ...  ...           ...</span>
<span class="go">                         9             9.6   0.002953  ...  4.089984e-06</span>
<span class="go">                                       9.7   0.009216  ...  1.163104e-05</span>
<span class="go">                                       9.8   0.001603  ...  5.611661e-06</span>
<span class="go">                                       9.9   0.000025  ...  9.778874e-07</span>
<span class="go">                                       10.0  0.002685  ...  1.019278e-06</span>
<span class="go">[1809 rows x 1001 columns]</span>
</pre></div>
</div>
<p>Return a pandas.DataFrame instead of a ivneuro.spectograms.PeriEventSpectogram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peri_event_spectogram</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">return_DataFrame</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">pes</span><span class="p">)</span>
<span class="go">pandas.core.frame.DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span>
<span class="go">                                                0.0    ...         500.0</span>
<span class="go">Variable_name Event_name Event_number Time             ...</span>
<span class="go">Signal 30Hz   Event      1            -10.0  0.003922  ...  7.248012e-08</span>
<span class="go">                                      -9.9   0.000142  ...  9.831598e-08</span>
<span class="go">                                      -9.8   0.020257  ...  2.587770e-06</span>
<span class="go">                                      -9.7   0.005431  ...  5.538603e-06</span>
<span class="go">                                      -9.6   0.002156  ...  5.956565e-06</span>
<span class="go">                                                  ...  ...           ...</span>
<span class="go">                         9             9.6   0.002953  ...  4.089984e-06</span>
<span class="go">                                       9.7   0.009216  ...  1.163104e-05</span>
<span class="go">                                       9.8   0.001603  ...  5.611661e-06</span>
<span class="go">                                       9.9   0.000025  ...  9.778874e-07</span>
<span class="go">                                       10.0  0.002685  ...  1.019278e-06</span>
<span class="go">[1809 rows x 1001 columns]</span>
</pre></div>
</div>
<p>Peri-event spectogram for 2 events and 3 signals, set frequency limits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peri_event_spectogram</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">lower_freq</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">higher_freq</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span><span class="o">.</span><span class="n">event_names</span>
<span class="go">[&#39;burst&#39;, &#39;control&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span><span class="o">.</span><span class="n">variable_names</span>
<span class="go">[&#39;Signal 30Hz&#39;, &#39;Signal 32Hz&#39;, &#39;Signal 80Hz&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pes</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(30.0, 150.0)</span>
</pre></div>
</div>
<p>Set signal1 and signal2 as replicates of sample1, and signal3 as sample3.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make dictionary to group replicates of each sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_subsamples</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Signal 30Hz&#39;</span><span class="p">,</span> <span class="s1">&#39;Signal 32Hz&#39;</span><span class="p">],</span> <span class="s1">&#39;sample2&#39;</span><span class="p">:[</span><span class="s1">&#39;Signal 80Hz&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate peri-event spectogram</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span> <span class="o">=</span> <span class="n">ivneuro</span><span class="o">.</span><span class="n">peri_event_spectogram</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">higher_freq</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">sample_subsamples</span> <span class="o">=</span> <span class="n">sample_subsamples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print variables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span><span class="o">.</span><span class="n">variable_names</span>
<span class="go">[&#39;sample1&#39;, &#39;sample2&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.normalize_pes">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">normalize_pes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Condition_average'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#normalize_pes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.normalize_pes" title="Permalink to this definition"></a></dt>
<dd><p>Normalize peri-event-histogram using the formula (X - Mean(baseline)) / Mean(baseline) for each frequency, where X is every value and Mean(baseline) is the mean value of a baseline.</p>
<p>While using decibels or logarithmic scale instead of power (V**2) can helph to displaying spectograms, usualy this is not enough to visualyze variations in both low and high frequencies.
Normalizing the data to a baseline is a simple and straingforward way to visualyze variation in all frequencies at the same scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pes</strong> (<em>pandas.DataFrame</em>) – Multi-index pandas.DataFrame as returned by peri_event_spectogram() function, with original continuous variable names, event names, event trial number and peri-event time as index, frequencies as columns and power values as data.</p></li>
<li><p><strong>baseline</strong> (<em>tuple</em><em>, </em><em>optional</em>) – lowest and highest time limits of the baseline, or None. If None, baseline = (lowest_lim, highest_lim) of the argument passed to pes. The default is None.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Method used to nromalize.
“Condition_average”: Mean(baseline) is calculated across all trials of all events and used to normalize the values of the peri-event spectogram.
“Condition_specific”: Mean(baseline) is calculated across all trials of each event, and used to normalize the data that specific event. This can be convenient when baselines differ between events.
“Trial_specific”: Mean(baseline) is calculated for each trial of each event, and used to normalize only that trial.
The default is ‘Condition_average’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If baseline is neither a tuple or None.</p></li>
<li><p><strong>NameError</strong> – If method is neither “Condition_average”, “Condition_specific” or “Trial_specific”.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>normalized_df</strong> – DataFrame with normalized data.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create events and signals, and make peri-event spectograms DataFrame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create events: burst and control</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">burst</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;burst&#39;</span><span class="p">:</span><span class="n">burst</span><span class="p">,</span><span class="s1">&#39;control&#39;</span><span class="p">:</span><span class="n">control</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal3</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">signal3</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peri_event_spectogram</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">return_DataFrame</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use function to normalize.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">normalize_pes</span><span class="p">(</span><span class="n">pes</span><span class="p">)</span>
<span class="go">                                                0.0    ...     500.0</span>
<span class="go">Variable_name Event_name Event_number Time             ...</span>
<span class="go">Signal 30Hz   burst      1            -10.0  0.253770  ... -0.979913</span>
<span class="go">                                      -9.9  -0.954578  ... -0.972753</span>
<span class="go">                                      -9.8   5.476162  ... -0.282843</span>
<span class="go">                                      -9.7   0.736362  ...  0.534932</span>
<span class="go">                                      -9.6  -0.310721  ...  0.650763</span>
<span class="go">                                                  ...  ...       ...</span>
<span class="go">Signal 80Hz   control    9             9.6  -0.258766  ...  0.130080</span>
<span class="go">                                       9.7  -0.689950  ... -0.864958</span>
<span class="go">                                       9.8  -0.795989  ... -0.800983</span>
<span class="go">                                       9.9  -0.800038  ...  0.999065</span>
<span class="go">                                       10.0 -0.859353  ...  4.566640</span>
<span class="go">[10854 rows x 1001 columns]</span>
</pre></div>
</div>
<p>Normalize to a baseline.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">normalize_pes</span><span class="p">(</span><span class="n">pes</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
<span class="go">                                                0.0    ...     500.0</span>
<span class="go">Variable_name Event_name Event_number Time             ...</span>
<span class="go">Signal 30Hz   burst      1            -10.0  0.284930  ... -0.980264</span>
<span class="go">                                      -9.9  -0.953449  ... -0.973230</span>
<span class="go">                                      -9.8   5.637114  ... -0.295378</span>
<span class="go">                                      -9.7   0.779516  ...  0.508103</span>
<span class="go">                                      -9.6  -0.293591  ...  0.621910</span>
<span class="go">                                                  ...  ...       ...</span>
<span class="go">Signal 80Hz   control    9             9.6  -0.240397  ...  0.110194</span>
<span class="go">                                       9.7  -0.682266  ... -0.867334</span>
<span class="go">                                       9.8  -0.790933  ... -0.804485</span>
<span class="go">                                       9.9  -0.795083  ...  0.963888</span>
<span class="go">                                       10.0 -0.855867  ...  4.468686</span>
<span class="go">[10854 rows x 1001 columns]</span>
</pre></div>
</div>
<p>Normalize using “Trial_specific” method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">normalize_pes</span><span class="p">(</span><span class="n">pes</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;Trial_specific&quot;</span><span class="p">)</span>
<span class="go">                                                0.0    ...     500.0</span>
<span class="go">Variable_name Event_name Event_number Time             ...</span>
<span class="go">Signal 30Hz   burst      1            -10.0  0.322110  ... -0.976902</span>
<span class="go">                                      -9.9  -0.952102  ... -0.968668</span>
<span class="go">                                      -9.8   5.829160  ... -0.175315</span>
<span class="go">                                      -9.7   0.831006  ...  0.765074</span>
<span class="go">                                      -9.6  -0.273151  ...  0.898273</span>
<span class="go">                                                  ...  ...       ...</span>
<span class="go">Signal 80Hz   control    9             9.6  -0.211468  ...  0.246262</span>
<span class="go">                                       9.7  -0.670165  ... -0.851075</span>
<span class="go">                                       9.8  -0.782971  ... -0.780522</span>
<span class="go">                                       9.9  -0.787279  ...  1.204586</span>
<span class="go">                                       10.0 -0.850378  ...  5.138939</span>
<span class="go">[10854 rows x 1001 columns]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.plot_pes">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">plot_pes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#plot_pes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.plot_pes" title="Permalink to this definition"></a></dt>
<dd><p>Plot peri-event spectograms, with each variable in a column and each event name in a row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pes</strong> (<em>pandas.DataFrame</em>) – Multi-index pandas.DataFrame as returned by peri_event_spectogram() nor normalize_pes() function, with original continuous variable names, event names, event trial number and peri-event time as index, frequencies as columns and power values as data.</p></li>
<li><p><strong>zero_centered</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If True, data is centered to zero. The default is True.</p></li>
<li><p><strong>aspect</strong> (<em>float</em><em>, </em><em>optional</em>) – The y/x ratio of the axes aspect. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create events and signals, and make peri-event spectograms DataFrame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create events: burst and control</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">burst</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;burst&#39;</span><span class="p">:</span><span class="n">burst</span><span class="p">,</span><span class="s1">&#39;control&#39;</span><span class="p">:</span><span class="n">control</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal3</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">burst</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">signal3</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pes</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">peri_event_spectogram</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">higher_freq</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">return_DataFrame</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use function to plot peri-event spectogram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">plot_pes</span><span class="p">(</span><span class="n">pes</span><span class="p">)</span>
</pre></div>
</div>
<p>Non zero centered.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ivn</span><span class="o">.</span><span class="n">plot_pes</span><span class="p">(</span><span class="n">pes</span><span class="p">,</span> <span class="n">zero_centered</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">PeriEventSpectogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram" title="Permalink to this definition"></a></dt>
<dd><p>Create a PeriEventHistogram object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – Multi-index pandas.DataFrame as returned by peri_event_spectogram() function, with original continuous variable names, event names, event trial number and peri-event time as index, frequencies as columns and power values as data.</p></li>
<li><p><strong>norm</strong> (<em>str</em>) – Normalization state of the data, it can be “None”, “Condition_average”, “Condition_specific” or “Trial_specific”.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#ivneuro.PeriEventSpectogram.data" title="Permalink to this definition"></a></dt>
<dd><p>Multi-index pandas.DataFrame with peri-event spectogram data, with original continuous variable names, event names, event trial number and peri-event time as index, frequencies as columns and power values as data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><a class="headerlink" href="#ivneuro.PeriEventSpectogram.variable_names" title="Permalink to this definition"></a></dt>
<dd><p>Names of each original continuous variable used to make the spectograms.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.event_names">
<span class="sig-name descname"><span class="pre">event_names</span></span><a class="headerlink" href="#ivneuro.PeriEventSpectogram.event_names" title="Permalink to this definition"></a></dt>
<dd><p>Names of each reference event.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.timestamps">
<span class="sig-name descname"><span class="pre">timestamps</span></span><a class="headerlink" href="#ivneuro.PeriEventSpectogram.timestamps" title="Permalink to this definition"></a></dt>
<dd><p>Timestamps of the peri-event spectogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.frequencies">
<span class="sig-name descname"><span class="pre">frequencies</span></span><a class="headerlink" href="#ivneuro.PeriEventSpectogram.frequencies" title="Permalink to this definition"></a></dt>
<dd><p>Frequencies included in the spectogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.normalization">
<span class="sig-name descname"><span class="pre">normalization</span></span><a class="headerlink" href="#ivneuro.PeriEventSpectogram.normalization" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>normalization state of the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">normalize():</span></span></dt>
<dd><p>Normalize data using the formula (X - Mean(baseline)) / Mean(baseline) for each frequency, where X is every value and Mean(baseline) is the mean value of a baseline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>baseline</strong> (<em>tuple</em><em>, </em><em>optional</em>) – lowest and highest time limits of the baseline, or None. If None, baseline = (lowest_lim, highest_lim) of the argument passed to pes. The default is None.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Method used to nromalize.
“Condition_average”: Mean(baseline) is calculated across all trials of all events and used to normalize the values of the peri-event spectogram.
“Condition_specific”: Mean(baseline) is calculated across all trials of each event, and used to normalize the data that specific event. This can be convenient when baselines differ between events.
“Trial_specific”: Mean(baseline) is calculated for each trial of each event, and used to normalize only that trial.
The default is ‘Condition_average’.</p></li>
<li><p><strong>inplace</strong> (<em>bolean</em><em>, </em><em>optional</em>) – If True, modifies the current object. If False, returns a new object with normalized data. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If baseline is neither a tuple or None.</p></li>
<li><p><strong>NameError</strong> – If method is neither “Condition_average”, “Condition_specific” or “Trial_specific”.</p></li>
<li><p><strong>ValueError</strong> – <p>If normalization attribute is not “None”, which indicates that data is already normalized.</p>
<dl class="simple">
<dt>Returns: PeriEventSpectogram</dt><dd><p>If inplace is False, returns a PeriEventSpectogram object with normalized data, and normalization attribute as the method argument passed.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>slice_time(new_limits, inplace=False):</p>
<blockquote>
<div><p>Slice timestamps.</p>
<dl class="simple">
<dt>new_limits: tuple</dt><dd><p>New lowest and highest limits of time.</p>
</dd>
<dt>inplace: bolean, optional</dt><dd><p>If True, modifies the current object. If False, returns a new object with sliced data. The default is False.</p>
</dd>
<dt>Returns: PeriEventSpectogram</dt><dd><p>New object with sliced timestamps</p>
</dd>
</dl>
</div></blockquote>
<p>slice_frequencies(new_limits, inplace=False):</p>
<blockquote>
<div><p>Slice frequencies.</p>
<dl class="simple">
<dt>new_limits: tuple</dt><dd><p>Lowest and highest limits of the frequency.</p>
</dd>
<dt>inplace: bolean, optional</dt><dd><p>If True, modifies the current object. If False, returns a new object with sliced data. The default is False.</p>
</dd>
<dt>Returns: PeriEventSpectogram</dt><dd><p>New object with sliced frequecies.</p>
</dd>
</dl>
</div></blockquote>
<p>slice_events(event_list, inplace=False):</p>
<blockquote>
<div><p>Slice events.</p>
<dl class="simple">
<dt>event_list: list</dt><dd><p>Event names to slice from the data.</p>
</dd>
<dt>inplace: bolean, optional</dt><dd><p>If True, modifies the current object. If False, returns a new object with sliced data. The default is False.</p>
</dd>
<dt>Returns: PeriEventSpectogram</dt><dd><p>New object with sliced events.</p>
</dd>
</dl>
</div></blockquote>
<p>calculate_means():</p>
<blockquote>
<div><p>Calculate means across trials of the same event for each variable, event name and timestamp.</p>
</div></blockquote>
<dl class="simple">
<dt>Returns: pandas.DataFrame</dt><dd><p>Mean across trials of the same event of the peri-event spectogram. Multi-index pandas.DataFrame with original continuous variable names,
event names and peri-event time as index, frequencies as columns and mean power values as data.</p>
</dd>
</dl>
<p>plot(zero_centered=None, aspect=1, variables = None, evt_names = None):</p>
<blockquote>
<div><p>Plot peri-event spectograms, with each variable in a column and each event name in a row.</p>
<dl class="simple">
<dt>zero_centered<span class="classifier">boolean or None, optional</span></dt><dd><p>If True, colorscale is centered to zero. If None, colorscale is centered to zero if data is normalized (normalization attribute is either “Condition_average”, “Condition_specific” or “Trial_specific”),
but it is not centered to zero if data is not normalized (normalization attribute is “None”). The default is None.</p>
</dd>
<dt>aspect<span class="classifier">float, optional</span></dt><dd><p>The y/x ratio of the axes aspect. The default is 1.</p>
</dd>
<dt>variables: list or None, optional</dt><dd><p>Subset of variables names to plot. If None, all variables are ploted. Default is None.</p>
</dd>
<dt>evt_names: list or None, optional</dt><dd><p>Subset of events to plot. If None, all events are ploted. Default is None.</p>
</dd>
</dl>
<p>None.</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.__str__" title="Permalink to this definition"></a></dt>
<dd><p>Return str(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.__repr__" title="Permalink to this definition"></a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram._set_variable_names">
<span class="sig-name descname"><span class="pre">_set_variable_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram._set_variable_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram._set_variable_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram._set_event_names">
<span class="sig-name descname"><span class="pre">_set_event_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram._set_event_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram._set_event_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram._set_timestamps">
<span class="sig-name descname"><span class="pre">_set_timestamps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram._set_timestamps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram._set_timestamps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram._set_frequencies">
<span class="sig-name descname"><span class="pre">_set_frequencies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram._set_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram._set_frequencies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Condition_average'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.normalize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.slice_time">
<span class="sig-name descname"><span class="pre">slice_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.slice_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.slice_time" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.slice_frequencies">
<span class="sig-name descname"><span class="pre">slice_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.slice_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.slice_frequencies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.slice_events">
<span class="sig-name descname"><span class="pre">slice_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.slice_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.slice_events" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.calculate_means">
<span class="sig-name descname"><span class="pre">calculate_means</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.calculate_means"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.calculate_means" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ivneuro.PeriEventSpectogram.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zero_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evt_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/spectograms.html#PeriEventSpectogram.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.PeriEventSpectogram.plot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.delta_power_spectral">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">delta_power_spectral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highest_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_subsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spectrum'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/delta_power_spectral.html#delta_power_spectral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.delta_power_spectral" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the power spectral at a experimental time of interest (exp_interval), at a baseline interval (baseline), and the frequency-basis normalized difference betrween the experimental interval and the baseline.</p>
<p>This function is based on the periodogram function of scipy.signal.
exp_interval and baseline must be lists of slices the same lenght, when when the lists have more than one element each, the results are the averages across intervals (either power spectral at exp_interval, power spectral at baseline, or their normalized difference).
To normalize, it uses the formula: (Power(exp_interval) - Power(baseline)) / (Power(exp_interval) + Power(baseline)) for each frequency and trial (pair of elements in interval and baseline), where Power(exp_interval) is the power at the experimental interval and Power(baseline) is the power at the baseline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contvar</strong> (<em>pandas.DataFrame</em>) – Dataframe with continuous variables in each column, and timestamps as index.</p></li>
<li><p><strong>exp_interval</strong> (<em>list</em>) – List of slices corresponding to experimental intervals to calculate power.</p></li>
<li><p><strong>baseline</strong> (<em>list</em>) – List of slices corresponding to baseline intervals to calculate power.</p></li>
<li><p><strong>lowest_freq</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – The lowest frequency to include in the power spectral. The default is 0.</p></li>
<li><p><strong>highest_freq</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – The highest freq to include in the power spectral. The default is 500.</p></li>
<li><p><strong>sample_subsamples</strong> (<em>dict</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – When a dict, key must be sample names and values must be lists of subsample names, e.g.: {‘sample_A’:[‘subsample_A1’,’subsample_A2’…’subsample_An’], ‘sample_B’:[‘subsample_B1’,’subsample_B2’…’subsample_Bn’]…}.
Power spectrals and normalized delta power spectral will be averaged across subsamples of the same sample.
It must only be used when contvar contains multiple replicates for each observation (e.g., local field potentials recorded with multiple wires of the same tetrode).
If None, each column of contvar is treated as an independent sample, and therefore the results contain spectrals of every contvar column. The default is None.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Sampling rate of the continuous variables. If None, the sampling_rate is calculated using the inverse of the median difference between consecutive timestamps of the contvar’s index. The default is None.</p></li>
<li><p><strong>nfft</strong> (<em>int</em><em>, </em><em>optional</em>) – The nfft parameter to enter to signal.spectrogram() function of the scipy package. Refer to scipy.signal.spectogram in scipy manual for more information. The default is 2000.</p></li>
<li><p><strong>scaling</strong> (<em>str</em><em>, </em><em>optional</em>) – The scaling parameter to enter to signal.spectrogram() function of the scipy package. Refer to scipy.signal.spectogram in scipy manual for more information. The default is ‘spectrum’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>power_exp_interval</strong> (<em>pandas.DataFrame</em>) – Power spectral for each variable (or sample if sample_subsamples != None), at the experimental interval. Variable names (or sample names) as columns and frequency as index.</p></li>
<li><p><strong>power_baseline</strong> (<em>pandas.DataFrame</em>) – Power spectral for each variable (or sample if sample_subsamples != None), at the baseline interval. Variable names (or sample names) as columns and frequency as index.</p></li>
<li><p><strong>delta_power</strong> (<em>pandas.DataFrame</em>) – Normalized difference of power spectrals between experimental interval and baseline interval, for each variable (or sample if sample_subsamples != None). Variable names (or sample names) as columns and frequency as index.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create event, intervals and signals.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span> <span class="c1"># Events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make intervals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_interval</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">make_intervals</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Experimental interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baseline</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">make_intervals</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#Baseline interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="mf">30.2</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal3</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">signal3</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate power spectral and delta power spectral between intervals with delta_power_spectral function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">exp_ps</span><span class="p">,</span> <span class="n">baseline_ps</span><span class="p">,</span> <span class="n">delta_ps</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">delta_power_spectral</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">exp_interval</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delta_ps</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">     Signal 30Hz  Signal 30.2Hz  Signal 80Hz</span>
<span class="go">0.0    -0.110932      -0.112460    -0.006010</span>
<span class="go">0.5    -0.087769       0.009546     0.149461</span>
<span class="go">1.0     0.180706       0.042875     0.142876</span>
<span class="go">1.5    -0.167544      -0.215748     0.257452</span>
<span class="go">2.0     0.108177      -0.357427     0.086913</span>
</pre></div>
</div>
<p>Set signal1 and signal2 as replicates of sample1, and signal3 as sample2.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make dictionary to group replicates of each sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_subsamples</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Signal 30Hz&#39;</span><span class="p">,</span> <span class="s1">&#39;Signal 30.2Hz&#39;</span><span class="p">],</span> <span class="s1">&#39;sample2&#39;</span><span class="p">:[</span><span class="s1">&#39;Signal 80Hz&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate coherence and delta coherence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_ps</span><span class="p">,</span> <span class="n">baseline_ps</span><span class="p">,</span> <span class="n">delta_ps</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">delta_power_spectral</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">exp_interval</span><span class="p">,</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">sample_subsamples</span> <span class="o">=</span> <span class="n">sample_subsamples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delta_ps</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">      sample1   sample2</span>
<span class="go">0.0 -0.111696 -0.006010</span>
<span class="go">0.5 -0.039112  0.149461</span>
<span class="go">1.0  0.111790  0.142876</span>
<span class="go">1.5 -0.191646  0.257452</span>
<span class="go">2.0 -0.124625  0.086913</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.delta_coherence">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">delta_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highest_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_subsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noverlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/delta_coherence.html#delta_coherence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.delta_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the coherence between 2 signals at a experimental interval of time of interest (exp_interval), at a baseline interval of time (baseline), and the difference betrween the spectral at the experimental interval and the baseline.</p>
<p>This function is based on the coherence function of scipy.signal, wich uses Welch’s method.
exp_interval and baseline must be lists of slices of the same lenght, when when the lists have more than one element each, the results are the averages across intervals (either coherence at exp_interval, coherence at baseline, or their difference).
To calculate the difference of coherence between experimental interval and baseline, the function subtracts the coherence at baseline from the coherence at exp_interval, for each frequency and trial (pair of elements in interval and baseline).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contvar</strong> (<em>pandas.DataFrame</em>) – Dataframe with continuous variables in each column, and timestamps as index.</p></li>
<li><p><strong>exp_interval</strong> (<em>list</em>) – List of slices corresponding to experimental intervals to calculate coherence.</p></li>
<li><p><strong>baseline</strong> (<em>list</em>) – List of slices corresponding to baseline intervals to calculate coherence.</p></li>
<li><p><strong>lowest_freq</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – The lowest frequency to include in the coherence spectral. The default is 0.</p></li>
<li><p><strong>highest_freq</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – The highest freq to include in the coherence spectral. The default is 500.</p></li>
<li><p><strong>sample_subsamples</strong> (<em>dict</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – When a dict, key must be sample names and values must be lists of subsample names, e.g.: {‘sample_A’:[‘subsample_A1’,’subsample_A2’…’subsample_An’], ‘sample_B’:[‘subsample_B1’,’subsample_B2’…’subsample_Bn’]…}.
Coherences and coeherence differences will be averaged across pairs of subsamples corresponding to the same samples pair.
It must only be used when contvar contains multiple replicates for each observation (e.g., local field potentials recorded with multiple wires of the same tetrode).
If None, each column of contvar is treated as an independent sample, and therefore the results contain coherences for every pair of contvar columns. The default is None.</p></li>
<li><p><strong>sampling_rate</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Sampling rate of the continuous variables, wich is used in signal.coherence() function of the scipy package. If None, the sampling_rate is calculated using the inverse of the median difference between consecutive timestamps of the contvar’s index. The default is None.</p></li>
<li><p><strong>nperseg</strong> (<em>int</em><em>, </em><em>optional</em>) – The nperseg parameter to enter to signal.coherence() function of the scipy package. Refer to scipy.signal.coherence in scipy manual for more information. The default is 500.</p></li>
<li><p><strong>noverlap</strong> (<em>int</em><em>, </em><em>optional</em>) – The noverlap parameter to enter to signal.coherence() function of the scipy package. Refer to scipy.signal.coherence in scipy manual for more information. The default is 400.</p></li>
<li><p><strong>nfft</strong> (<em>int</em><em>, </em><em>optional</em>) – The nfft parameter to enter to signal.coherence() function of the scipy package. Refer to scipy.signal.coherence in scipy manual for more information. The default is 2000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>coherence_exp_interval</strong> (<em>pandas.DataFrame</em>) – Coherence for each pair of variables (or pair of samples if sample_subsamples != None), at the experimental interval. Variable names (or sample names) as 2-levels columns (one level for each member of the pair) and frequency as index.</p></li>
<li><p><strong>power_baseline</strong> (<em>pandas.DataFrame</em>) – Coherence for each pair of variables (or pair of samples if sample_subsamples != None), at the baseline interval. Variable names (or sample names) as 2-levels columns (one level for each member of the pair) and frequency as index.</p></li>
<li><p><strong>delta_coherence</strong> (<em>pandas.DataFrame</em>) – Difference of coherence between experimental interval and baseline interval, for each pair of variables (or pair of samples if sample_subsamples != None). Variable names (or sample names) as 2-levels columns (one level for each member of the pair) and frequency as index.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create event, intervals and signals.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ivneuro</span> <span class="k">as</span> <span class="nn">ivn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span> <span class="c1"># Events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make intervals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_interval</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">make_intervals</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Experimental interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baseline</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">make_intervals</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#Baseline interval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal1</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal2</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="mf">30.2</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal3</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">burst_amplitude</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">signal3</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate coherence and delta coherence between intervals with delta_coherence function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">exp_coh</span><span class="p">,</span> <span class="n">baseline_coh</span><span class="p">,</span> <span class="n">delta_coh</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">delta_coherence</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">exp_interval</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delta_coh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">      Signal 30Hz             Signal 30.2Hz</span>
<span class="go">    Signal 30.2Hz Signal 80Hz   Signal 80Hz</span>
<span class="go">0.0     -0.079927   -0.024874      0.068144</span>
<span class="go">0.5     -0.045909   -0.058171      0.043984</span>
<span class="go">1.0     -0.019668   -0.081587      0.025753</span>
<span class="go">1.5     -0.015086   -0.076264      0.023711</span>
<span class="go">2.0     -0.016446   -0.059058      0.025952</span>
</pre></div>
</div>
<p>Set signal1 and signal2 as replicates of sample1, and signal3 as sample2.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make dictionary to group replicates of each sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_subsamples</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Signal 30Hz&#39;</span><span class="p">,</span> <span class="s1">&#39;Signal 30.2Hz&#39;</span><span class="p">],</span> <span class="s1">&#39;sample2&#39;</span><span class="p">:[</span><span class="s1">&#39;Signal 80Hz&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate coherence and delta coherence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_coh</span><span class="p">,</span> <span class="n">baseline_coh</span><span class="p">,</span> <span class="n">delta_coh</span> <span class="o">=</span> <span class="n">ivn</span><span class="o">.</span><span class="n">delta_coherence</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">exp_interval</span><span class="p">,</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">sample_subsamples</span> <span class="o">=</span> <span class="n">sample_subsamples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delta_coh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">      sample1</span>
<span class="go">      sample1   sample2</span>
<span class="go">0.0 -0.079927  0.021635</span>
<span class="go">0.5 -0.045909 -0.007093</span>
<span class="go">1.0 -0.019668 -0.027917</span>
<span class="go">1.5 -0.015086 -0.026276</span>
<span class="go">2.0 -0.016446 -0.016553</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ivneuro.generate_signal">
<span class="sig-prename descclassname"><span class="pre">ivneuro.</span></span><span class="sig-name descname"><span class="pre">generate_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burst_timestamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burst_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burst_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burst_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ivneuro/generate_signal.html#generate_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ivneuro.generate_signal" title="Permalink to this definition"></a></dt>
<dd><p>Generate a signal with pink noise and increases in power (bursts) at a specified frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>int</em><em> or </em><em>float</em>) – Duration of the signal in seconds.</p></li>
<li><p><strong>burst_timestamps</strong> (<em>list</em><em> of </em><em>floats</em>) – Timestamps at wich the increases in power must occur.</p></li>
<li><p><strong>burst_frequency</strong> (<em>int</em><em> or </em><em>float</em>) – Frequency at wich the signal displays increases in power.</p></li>
<li><p><strong>burst_duration</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Duration (in seconds) of high power burst. The default is 2.</p></li>
<li><p><strong>burst_amplitude</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Amplitud of the signal used to create the increases in power. The default is 0.1.</p></li>
<li><p><strong>sampling_frequency</strong> (<em>int</em><em>, </em><em>optional</em>) – Sampling frequency. The default is 1000.</p></li>
<li><p><strong>int</strong> (<em>seed =</em>) – </p></li>
<li><p><strong>optional</strong> – </p></li>
<li><p><strong>40.</strong> (<em>Value for np.random.seed to generate pink noise. The default is</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>signal</strong> – Timestamps as index and signal values as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nex/index.html" class="btn btn-neutral float-right" title="ivneuro.nex" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Eric Casey.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>